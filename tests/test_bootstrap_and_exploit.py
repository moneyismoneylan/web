import base64
import types
import os
import sys
sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), "..")))

from sqli_hunter.bootstrap import load_config
from sqli_hunter.exploiter import Exploiter


def test_load_config_waf():
    sigs = load_config("waf_signatures")
    assert "F5 ASM" in sigs


def test_side_channel_encoding():
    e = Exploiter(types.SimpleNamespace())
    encoded = e._encode_side_channel_data("secret")
    assert base64.b64decode(encoded.encode()).decode() == "secret"
